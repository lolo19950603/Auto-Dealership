<%- include('../partials/header') %>

<div class="container">
  <div id="search-row" class="row">
    <form action="/users/<%= user._id %>/new" method="GET">
      <label>Select Model:</label>
      <select name="year" onchange="this.form.submit()">
        <option value="" disabled selected><%= 'year' in search ? search.year : 'year' %></option>
        <% let duplicateYears = [] %>
        <% let sortedYears = [] %>
        <% cars.forEach(car => { %>
          <% if (!(duplicateYears.includes(car.year))) { %>
            <% sortedYears.push(car.year) %>
            <% duplicateYears.push(car.year) %>
          <% } %>
        <% }) %> 
        <% sortedYears.sort().forEach(year => { %>
          <option value="<%= year %>"><%= year %></option>
        <% }) %>
      </select>
      <select name="make" onchange="this.form.submit()">
        <option value="" disabled selected><%= 'make' in search ? search.make : 'make' %></option>
        <% let duplicateCars = [] %>
        <% cars.forEach(car => { %>
          <% if (!(duplicateCars.includes(car.make))) { %>
            <option value="<%= car.make %>"><%= car.make %></option>
            <% duplicateCars.push(car.make) %>
          <% } %>
        <% }) %> 
      </select>
      <select name="model" onchange="this.form.submit()">
        <option value="" disabled selected><%= 'model' in search ? search.model : 'model' %></option>
        <% let duplicateModels = [] %>
        <% cars.forEach(car => { %>
          <% if (!(duplicateModels.includes(car.model))) { %>
            <option value="<%= car.model %>"><%= car.model %></option>
            <% duplicateModels.push(car.model) %>
          <% } %>
        <% }) %> 
      </select>
      <a href="/users/<%= user._id %>/new/reset">reset</a>
    </form>
  </div>

  <form action="/users" method="POST">
    <label>Enter Mileage:</label>
    <input type="number" name="seat"> KM
    <br><label>Enter Selling Price: $</label>
    <input type="number" name="price">
    <br><label>Description:</label>
    <input type="text" name="description">
    <br><input type="submit" value="Create">
  </form>
</div>
  
<%- include('../partials/footer') %>