<!DOCTYPE html>
<html>
  <head>
    <title>Autofinder</title>
    <!-- Google Icon Fonts used by Materialize -->
    <link
      href="https://fonts.googleapis.com/icon?family=Material+Icons"
      rel="stylesheet"
    />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-gH2yIJqKdNHPEq0n4Mqa/HGKIhSkIHeL5AyhkYV8i59U5AR6csBvApHHNl/vI1Bx"
      crossorigin="anonymous"
    />
    <!-- Materialize CSS Framework -->
    <link rel="stylesheet" href="stylesheets/style.css" />
    <!-- JavaScript for Materialize -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script>
  </head>

  <body>
    <nav class="navbar navbar-expand-lg bg-light">
      <div class="container-fluid">
        <a href="" class="navbar-brand">Autofinder</a>
        <div>
          <ul class="nav">
            <% if (user) { %>
            <li class="nav-item">
              <a class="nav-link" href="/autofinder/users/<%= user.googleId %>"><span class="material-icons">account_circle</span>Profile</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="/logout"><span class="material-icons">logout</span>Log Out</a>
            </li>
            <% } else { %>
            <li class="nav-item">
              <a class="nav-link" href="/auth/google"><span class="material-icons">login</span>Login with Google</a>
            </li>
            <% } %>
          </ul>
        </div>
      </div>
    </nav>

    <div class="container">
      <div id="search-row" class="row">
        <form action="/autofinder" method="GET">
          <select name="year" onchange="this.form.submit()">
            <option value="" disabled selected><%= 'year' in search ? search.year : 'year' %></option>
            <% let duplicateYears = [] %>
            <% let sortedYears = [] %>
            <% cars.forEach(car => { %>
              <% if (!(duplicateYears.includes(car.year))) { %>
                <% sortedYears.push(car.year) %>
                <% duplicateYears.push(car.year) %>
              <% } %>
            <% }) %> 
            <% sortedYears.sort().forEach(year => { %>
              <option value="<%= year %>"><%= year %></option>
            <% }) %>
          </select>
          <select name="make" onchange="this.form.submit()">
            <option value="" disabled selected><%= 'make' in search ? search.make : 'make' %></option>
            <% let duplicateCars = [] %>
            <% cars.forEach(car => { %>
              <% if (!(duplicateCars.includes(car.make))) { %>
                <option value="<%= car.make %>"><%= car.make %></option>
                <% duplicateCars.push(car.make) %>
              <% } %>
            <% }) %> 
          </select>
          <select name="model" onchange="this.form.submit()">
            <option value="" disabled selected><%= 'model' in search ? search.model : 'model' %></option>
            <% let duplicateModels = [] %>
            <% cars.forEach(car => { %>
              <% if (!(duplicateModels.includes(car.model))) { %>
                <option value="<%= car.model %>"><%= car.model %></option>
                <% duplicateModels.push(car.model) %>
              <% } %>
            <% }) %> 
          </select>
          <a href="/autofinder/reset">reset</a>
        </form>
      </div>
    </div>
  </body>
</html>
