<%- include('../partials/header') %>
<h1><%= title %></h1>
<div class="container">
  <div id="search-row" class="row">
    <form action="/ads" method="GET">
      <select name="year" onchange="this.form.submit()">
        <option value="" disabled selected>
          <%= 'year' in search ? search.year : 'year' %>
        </option>
        <% let duplicateYears = [] %> <% let sortedYears = [] %> <%
        cars.forEach(car => { %> <% if (!(duplicateYears.includes(car.year))) {
        %> <% sortedYears.push(car.year) %> <% duplicateYears.push(car.year) %>
        <% } %> <% }) %> <% sortedYears.sort().forEach(year => { %>
        <option value="<%= year %>"><%= year %></option>
        <% }) %>
      </select>
      <select name="make" onchange="this.form.submit()">
        <option value="" disabled selected>
          <%= 'make' in search ? search.make : 'make' %>
        </option>
        <% let duplicateCars = [] %> <% cars.forEach(car => { %> <% if
        (!(duplicateCars.includes(car.make))) { %>
        <option value="<%= car.make %>"><%= car.make %></option>
        <% duplicateCars.push(car.make) %> <% } %> <% }) %>
      </select>
      <select name="model" onchange="this.form.submit()">
        <option value="" disabled selected>
          <%= 'model' in search ? search.model : 'model' %>
        </option>
        <% let duplicateModels = [] %> <% cars.forEach(car => { %> <% if
        (!(duplicateModels.includes(car.model))) { %>
        <option value="<%= car.model %>"><%= car.model %></option>
        <% duplicateModels.push(car.model) %> <% } %> <% }) %>
      </select>
      <a href="ads/reset">reset</a>
    </form>
  </div>
</div>

<div class="ads">
  <% ads.forEach(ad => { %>
  <br /><%= ad.title; %><br />
  <img src="<%= ad.pictures[0] %>" width="150" /><br />
  $<%= ad.price; %><br />
  <%= ad.milege; %>km<br />
  <a href="/ads/<%= ad._id %>">view</a><br />
  <% })%>
</div>

<%- include('../partials/footer') %>
